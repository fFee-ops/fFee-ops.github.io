---
title: Hystrix断路器概述
date: 2020-10-21 10:18:35
tags: 
categories: Hystrix
---

<!--more-->

### Hystrix断路器概述

- [分布式系统面临的问题](#_7)
- [Hystrix是什么](#Hystrix_15)
- [Hystrix能干嘛](#Hystrix_20)
- [Hystrix重要概念](#Hystrix_27)
- - [服务降级](#_28)
  - [服务熔断](#_36)
  - [服务限流](#_40)

**[Hystrix官宣，停更进维](https://github.com/Netflix/Hystrix)** 即：  
1、被动修复bugs  
2、不再接受合并请求  
3、不再发布新版本

# 分布式系统面临的问题

![在这里插入图片描述](https://img-blog.csdnimg.cn/20201021095710974.png?x-oss-process=image/watermark,type_ZmFuZ3poZW5naGVpdGk,shadow_10,text_aHR0cHM6Ly9ibG9nLmNzZG4ubmV0L3FxXzIxMDQwNTU5,size_16,color_FFFFFF,t_70#pic_center)  
服务雪崩

- 多个微服务之间调用的时候,假设微服务A调用微服务B和微服务C,微服务B和微服务C又调用其它的微服务,这就是所谓的 **“扇出”。** 如果扇出的链路上某个微服务的调用响应时间过长或者不可用,对微服务A的调用就会占用越来越多的系统资源,进而引起系统崩溃,所谓的“雪崩效应”。

- 对于高流量的应用来说,单的后端依赖可能会导致所有服务器上的所有资源都在几秒钟内饱和。比失败更糟糕的是,这些应用程序还可能导致服务之间的延迟增加,备份队列,线程和其他系统资源紧张,导致整个系统发生更多的级联故障。这些都表示需要对故障和延迟进行隔离和管理,以便单个依赖关系的失败,不能取消整个应用程序或系统。

- 所以,通常当你发现一个模块下的某个实例失败后,这时候这个模块依然还会接收流量,然后这个有冋题的模块还调用了其他的模块,这样就 会发生级联故障,或者叫雪崩。

# Hystrix是什么

- Hystrix是一个用于处理分布式系统的**延迟**和**容错**的开源库,在分布式系统里,许多依赖不可避免的会调用失败,比如超时、异常等,  
  Hystrix能够保证在一个依赖出问题的情况下,**不会导致整体服务失败**,避免级联故障,以提高分布式系统的弹性
- “断路器”本身是种开关装置,当某个服务单元发生故障之后,通过断路器的故障监控\(类似熔断保险丝\),**向调用方返回个符合预期的、可处理的备选响应\( FallBack）,而不是长时间的等待或者抛出调用方无法处理的异常**,这样就保证了服务调用方的线程不会被长时间、不必要地占用,从而避免了故障在分布式系统中的蔓延,乃至雪崩。

# Hystrix能干嘛

1、服务降级  
2、服务熔断  
3、接近实时的监控

# Hystrix重要概念

## 服务降级

即当客户的请求发生问题后，不让客户端等待并立刻返回一个友好提示，用fallback方法来实现这一点。（通俗来说，加入有一个请求发生问题了，要有一个方法给它兜底）

**哪些情况会触发降级？**  
1、程序运行异常  
2、超时  
3、服务熔断触发服务降级  
4、线程池/信号量打满也会导致服务降级

## 服务熔断

**类比保险丝达到最大服务访问后，直接拒绝访问，拉闸限电，然后调用服务降级的方法并返回友好提示**

服务的降级->进而熔断->恢复调用链路

## 服务限流

**秒杀高并发等操作，严禁一窝蜂的过来拥挤，大家排队，一秒钟N个，有序进行**